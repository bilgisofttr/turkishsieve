<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>6n±1 Animasyon - 5, 7 Çemberleri</title>
  <script src="https://cdn.jsdelivr.net/npm/p5@1.9.0/lib/p5.min.js"></script>
</head>
<body>
<script>
let numbers = [];
let boxSize = 57; 
let wheelRadius5, wheelRadius7;
let angle5 = 0, angle7 = 0;
let rotating5 = false, rotating7 = false;
let speed = 6; 
let offset = 0;
const gap =50;

let startMoving = false;
let startTime;

// 5 çemberi
const wheelUnits5 = 10;
const firstTick5 = 7;
const secondTick5 = 10;
const number5 = 5;

// 7 çemberi
const wheelUnits7 = 14; 
const firstTick7 = 9;   
const secondTick7 = 14; 
const number7 = 7;

const tickLength = 20; 

let coloredBoxes5 = [];
let coloredBoxes7 = [];

// yeni kümeler
let primes = [2,3];
let notPrimes = [];


function setup() {
  createCanvas(windowWidth, windowHeight);

  // Çemberler kutu boyuna göre orantılı
  wheelRadius5 = (boxSize * wheelUnits5) / (2 * PI);
  wheelRadius7 = (boxSize * wheelUnits7) / (2 * PI);


  for (let n = 1; n <= 200; n++) {
    numbers.push(6*n - 1);
    if (n !=200) numbers.push(6*n + 1);
    coloredBoxes5.push(false);
    coloredBoxes7.push(false);

  }
  
      // 2 saniye sonra hareketi başlat
  startTime = millis();
}

function draw() {
  background(30);
    drawTitle();
  // üstte kümeleri yaz
  drawSets();
  drawBoxes();

  // Çemberler X koordinatları
  let wheel5X = width - wheelRadius5 - 550;
  let wheel7X = wheel5X - wheelRadius5 - wheelRadius7 - gap;


  // 5 çemberi
  drawWheel(wheel5X, wheelRadius5, wheelUnits5, firstTick5, secondTick5, number5,tickLength, rotating5, angle5, 
            (a)=>{angle5 += (speed/boxSize)*(TWO_PI/wheelUnits5);}, "blue");

  // 7 çemberi
  drawWheel(wheel7X, wheelRadius7, wheelUnits7, firstTick7, secondTick7,number7, tickLength, rotating7, angle7, 
            (a)=>{angle7 += (speed/boxSize)*(TWO_PI/wheelUnits7);}, "darkgreen");

}

function drawWheel(baseX, radius, units, tick1, tick2,number, tickLen, rotating, angle, updateFunc, colorName){
  push();
  let wheelY = height - (boxSize*3) - 40 - radius; // kutular üç satır oldu
  translate(baseX, wheelY);

  let startAngle = PI/2; 
  if(rotating) updateFunc();
  rotate(startAngle + angle);

  noFill();
  stroke(255);
  strokeWeight(2);
  ellipse(0, 0, radius*2);

  strokeWeight(4);
  const tickPositions = [tick1, tick2];
  for(let i of tickPositions){
    let a = (i-1)*(TWO_PI/units);
    let x1 = cos(a)*radius;
    let y1 = sin(a)*radius;
    let x2 = cos(a)*(radius - tickLen);
    let y2 = sin(a)*(radius - tickLen);
    line(x1, y1, x2, y2);
  }

  // Çember merkezine yazı (dönmeden)
  push();
  rotate(-startAngle - angle);
  fill(colorName);
  noStroke();
  textAlign(CENTER, CENTER);
  textSize(16);
  //text(`Units: ${units}, Ticks: ${tick1},${tick2}`, 0, 0);
  // İlk satır: Units
  text(`Units: 2x${number}=${units}`, 0, -10);
  // İkinci satır: Ticks
  text(`Ticks: ${tick1}, ${tick2}`, 0, 10);
  textSize(18);
  textStyle(BOLD);
  // üçüncü satır: sayı
  text(`Prime: ${number}`, 0, -radius-40);
  
  // dördüncü satır: start
  text(`Start Number: 5x${number}=${5*number}`, 0, -radius-20);
  
  pop();

  pop();
}

function drawBoxes(){
  let baseY = height - boxSize*3 - 40; // üç satır için yukarı al
    if(!startMoving){
    if(millis() - startTime > 2000){ // 2000 ms = 2 saniye
      startMoving = true;
    }
  }

  if(startMoving){
    offset += speed;
  }
  
  let wheel5X = width - wheelRadius5 - 577;
  let wheel7X = wheel5X - wheelRadius5 - wheelRadius7 - gap;


  // Başlık kutuları (sabit)
  let labelW = boxSize*1.5;
  drawLabelBox(10, baseY, "Numbers", labelW);
  drawLabelBox(10, baseY + boxSize, "Index", labelW);
  drawLabelBox(10, baseY + boxSize*2, "Is prime?", labelW);

  for(let i=0; i<numbers.length; i++){
    let x = width - (offset - i*boxSize);

if(x + boxSize < 0){
  let isComposite5 = coloredBoxes5[i];
  let isComposite7 = coloredBoxes7[i];

  // Eğer hem 5 hem 7 çarpanlarıyla elendiyse composite sayılır
  let isComposite = isComposite5 || isComposite7;

  if(isComposite){
    if(!notPrimes.includes(numbers[i])){
      notPrimes.push(numbers[i]);
    }
  } else {
    if(!primes.includes(numbers[i])){
      primes.push(numbers[i]);
    }
  }
  continue; // artık çizmiyoruz
}

	

	
    // kutular başlık kutusunun soluna gelince kaybolacak
    if(x < 10 + labelW) continue;
    if(x > width + boxSize) continue;





    // 5 çemberi
    if(!rotating5 && numbers[i] === 25 && x < wheel5X + boxSize && x > wheel5X - boxSize) rotating5 = true;
    if(numbers[i] >= 25 && numbers[i] % 5 === 0 &&
       x + boxSize/2 >= wheel5X - boxSize/2 && x + boxSize/2 <= wheel5X + boxSize/2) {
      coloredBoxes5[i] = true;
    }

    // 7 çemberi
    if(!rotating7 && numbers[i] === 35 && x < wheel7X + boxSize && x > wheel7X - boxSize) rotating7 = true;
    if(numbers[i] >= 35 && numbers[i] % 7 === 0 &&
       x + boxSize/2 >= wheel7X - boxSize/2 && x + boxSize/2 <= wheel7X + boxSize/2) {
      coloredBoxes7[i] = true;
    }




    // Renk seçimi öncelik: 5 > 7 > 11 > 13
    let fillColor = coloredBoxes5[i] ? color(0,0,255) :
                    (coloredBoxes7[i] ? color(0,100,0) : 255);
    let textColor = (coloredBoxes5[i] || coloredBoxes7[i] ) ? color(255) : color(0);

    // Numbers satırı
    fill(fillColor);
    stroke(0);
    rect(x, baseY, boxSize, boxSize);
    fill(textColor);
    noStroke();
    textAlign(CENTER, CENTER);
    textSize(boxSize/3);
    text(numbers[i], x + boxSize/2, baseY + boxSize/2);

    // Index satırı
    fill(255);
    stroke(0);
    rect(x, baseY + boxSize, boxSize, boxSize);
    fill(0);
    noStroke();
    text(i, x + boxSize/2, baseY + boxSize + boxSize/2);

    // Is prime? satırı
    let isComposite = (coloredBoxes5[i] || coloredBoxes7[i] );
    // Index satırı (2. satır)
let indexFill, indexText;
if(isComposite){
  indexFill = color(100);  // gri
  indexText = color(255);  // beyaz
} else {
  indexFill = color(255);  // beyaz
  indexText = color(0);    // siyah
}
fill(indexFill);
stroke(0);
rect(x, baseY + boxSize, boxSize, boxSize);
fill(indexText);
noStroke();
text(i, x + boxSize/2, baseY + boxSize + boxSize/2);

// Is prime? satırı (3. satır)
if(isComposite){
  fill(100); // gri arkaplan
  stroke(0);
  rect(x, baseY + boxSize*2, boxSize, boxSize);
  fill(255); // beyaz yazı
  noStroke();
  text("False", x + boxSize/2, baseY + boxSize*2 + boxSize/2);
} else {
  fill(255); // beyaz arkaplan
  stroke(0);
  rect(x, baseY + boxSize*2, boxSize, boxSize);
  fill(0); // siyah yazı
  noStroke();
  text("True", x + boxSize/2, baseY + boxSize*2 + boxSize/2);
}
  }
}

function drawLabelBox(x, y, label, w){
  fill(200);
  stroke(0);
  rect(x, y, w, boxSize);
  fill(0);
  noStroke();
  textAlign(CENTER, CENTER);
  textSize(boxSize/3);
  text(label, x + w/2, y + boxSize/2);
}

function drawSets(){
return;
  fill(255);
  noStroke();
  textAlign(CENTER, TOP);
  textSize(20);
  text("primes = {" + primes.join(", ") + "}", width/2, 20);
  text("composites = {" + notPrimes.join(", ") + "}", width/2, 50);
}

function drawTitle(){
  const title = "The Turkish Sieve";
  const y = 100;             // üstten 100px aşağı
  const x = width / 2;       // yatay ortala

  // gölge (daha koyu, hafif aşağıda)
  push();
  textAlign(CENTER, TOP);
  textSize(48);              // büyük yazı; istersen 56, 64 yapabilirsin
  textStyle(BOLD);
  noStroke();
  fill(0, 60);               // yarı saydam siyah gölge
  text(title, x + 4, y + 6); // gölge için hafif sağ-aşağı offset
  pop();

  // ana dolgu (gradient yoksa tek renk)
  push();
  textAlign(CENTER, TOP);
  textSize(48);
  textStyle(BOLD);
  // dolgu rengi
  fill(250, 220, 100);       // sıcak sarı/altın tonu (isteğe göre değiştir)
  // dış hat (stroke) ile belirginleştirme
  stroke(30, 30, 60);        // koyu mavi-gri hat
  strokeWeight(3);
  text(title, x, y);
  pop();

  // isteğe bağlı: alt başlık (küçük, ince)
  push();
  textAlign(CENTER, TOP);
  textSize(14);
  textStyle(NORMAL);
  noStroke();
  fill(200);
  text("Algorithm & Animation Creator : Hüseyin Çakanlı", x, y + 60);
  pop();
}

</script>
</body>
</html>
